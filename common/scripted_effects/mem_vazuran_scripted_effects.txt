#sets up the systems around empires and activates the crisis
start_mem_vazuran_menace = {
	set_global_flag = mem_vazurans_enabled
	every_country = {
		limit = {
			is_country_type = default
		}
		random_list = {
			1 = {
				capital_scope = {
					solar_system = {
						random_neighbor_system = {
							random_neighbor_system = {
								limit = {
									NOT = {
										has_star_flag = empire_home_system
									}
									any_system_planet = {
										OR = {
											is_planet_class = pc_barren
											is_planet_class = pc_barren_cold
											is_planet_class = pc_toxic
											is_planet_class = pc_frozen
										}
									}
								}
								set_star_flag = mem_vazuran_destroyed_planet_system
								random_system_planet = {
									limit = {
										OR = {
											is_planet_class = pc_barren
											is_planet_class = pc_barren_cold
											is_planet_class = pc_toxic
											is_planet_class = pc_frozen
										}
									}
									random_list = {
										1 = {
											change_pc = pc_shattered
										}
										1 = {
											change_pc = pc_broken
										}
									}
									set_planet_flag = mem_vazuran_destroyed_planet
								}
							}
						}
					}
				}
			}
			1 = {
			}
		}
	}
	random_country = {
		limit = {
			is_country_type = global_event
		}
		country_event = { id = mem_vazurans.401 days = 7200 random = 1000 } # TODO change to 30 years later
		country_event = { id = mem_vazurans.402 days = 7200 random = 1000 }
		country_event = { id = mem_vazurans.403 days = 7200 random = 1000 }
		country_event = { id = mem_vazurans.404 days = 7200 random = 1000 }
		country_event = { id = mem_vazurans.405 days = 7200 random = 1000 }
	}
}

# Checks if Ancient_Protectors country (global event target) exists
# Creates the country and saves it if it does not
create_mem_vazuran_country = {
	if = {
		limit = {
			NOT = {
				exists = event_target:mem_vazurans_country
			}
		}
		create_species = {
			name = "Vazurans"
			class = ART
			portrait = art17
			traits = {
				trait = trait_intelligent
				trait = trait_natural_physicists
				trait = trait_venerable
				trait = trait_slow_breeders
				trait = trait_weak
			}
			extra_trait_points = 3
		}
		create_country = {
			name = "Vazuran Hegemony"
			name_list = "ART2"
			type = mem_vazurans
			ignore_initial_colony_error = yes
			authority = auth_dictatorial
			civics = {
				civic = civic_warrior_culture
				civic = civic_nationalistic_zeal
			}
			species = last_created_species
			ethos = {
				ethic = ethic_xenophobe
				ethic = ethic_fanatic_militarist
			}
			flag = {
				icon = {
					category = "domination"
					file = "domination_21.dds"
				}
				background= {
					category = "backgrounds"
					file = "00_solid.dds"
				}
				colors={
					"black"
					"dark_purple"
					"null"
					"null"
				}
			}
			effect = {
				set_country_flag = mem_vazurans_country	
			}
		}
		last_created_country = {
			set_graphical_culture = mem_ancient_02
			save_global_event_target_as = mem_vazurans_country
		}
		# Should not attack Enclaves, Guardians, ai empires or the surveyor probe
        every_country = {
            limit = {
                OR = {
					is_country_type = enclave
					is_country_type = primitive
					has_country_flag = mem_surveyor_country
					is_guardian_country = yes
					AND = {
						is_country_type = default
						is_ai = yes
					}
                }
            }
            event_target:mem_vazurans_country = {
                set_faction_hostility = {
                    target = prev
                    set_hostile = no
                    set_neutral = no
                    set_friendly = yes
                }
            }
		}
	}
}

create_mem_vazuran_corvette_stage_fleet = {
	create_fleet = {
		name = "Raiders"
		settings = {
			spawn_debris = no 
			is_boss = no
		}
		effect = {
			set_owner = event_target:mem_vazurans_country
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			set_location = {
				target = PREV
				distance = 0
				angle = random 
			}
		}
	}
}

create_mem_vazuran_destroyer_stage_fleet = {
	create_fleet = {
		name = "Raiders"
		settings = {
			spawn_debris = no 
			is_boss = no
		}
		effect = {
			set_owner = event_target:mem_vazurans_country
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			set_location = {
				target = PREV
				distance = 0
				angle = random 
			}
		}
	}
}

create_mem_vazuran_cruiser_stage_fleet = {
	create_fleet = {
		name = "Raiders"
		settings = {
			spawn_debris = no 
			is_boss = no
		}
		effect = {
			set_owner = event_target:mem_vazurans_country
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			set_location = {
				target = PREV
				distance = 0
				angle = random 
			}
		}
	}
}

create_mem_vazuran_battleship_stage_fleet = {
	create_fleet = {
		name = "Raiders"
		settings = {
			spawn_debris = no 
			is_boss = no
		}
		effect = {
			set_owner = event_target:mem_vazurans_country
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			set_location = {
				target = PREV
				distance = 0
				angle = random 
			}
		}
	}
}

create_mem_vazuran_xl_01_stage_fleet = {
	create_fleet = {
		name = "Raiders"
		settings = {
			spawn_debris = no 
			is_boss = no
		}
		effect = {
			set_owner = event_target:mem_vazurans_country
			create_ship = {
				name = random
				design = "NAME_Vazuran_Cruiser"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			set_location = {
				target = PREV
				distance = 0
				angle = random 
			}
		}
	}
}

create_mem_vazuran_xl_02_stage_fleet = {
	create_fleet = {
		name = "Raiders"
		settings = {
			spawn_debris = no 
			is_boss = no
		}
		effect = {
			set_owner = event_target:mem_vazurans_country
			create_ship = {
				name = random
				design = "NAME_Vazuran_Cruiser"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Cruiser"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			set_location = {
				target = PREV
				distance = 0
				angle = random 
			}
		}
	}
}

create_mem_vazuran_retaliation_fleet = {
	create_fleet = {
		name = "Punishers"
		settings = {
			spawn_debris = no 
			is_boss = no
		}
		effect = {
			set_owner = event_target:mem_vazurans_country
			create_ship = {
				name = random
				design = "NAME_Vazuran_Cruiser"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Cruiser"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Cruiser"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Cruiser"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Cruiser"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			set_location = {
				target = PREV
				distance = 0
				angle = random 
			}
		}
	}
}

create_mem_vazuran_garrison_fleet = {
	create_fleet = {
		name = "Garrison Fleet"
		settings = {
			spawn_debris = no 
			is_boss = no
		}
		effect = {
			set_owner = event_target:mem_vazurans_country
			create_ship = {
				name = random
				design = "NAME_Vazuran_Cruiser"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Cruiser"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Cruiser"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Cruiser"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Cruiser"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Escort"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Control_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			create_ship = {
				name = random
				design = "NAME_Vazuran_Combat_Drone"
				graphical_culture = "mem_ancient_02"
			}
			set_location = {
				target = PREV
				distance = 0
				angle = random 
			}
			set_formation_scale = 5
			set_fleet_stance = aggressive
			set_aggro_range = 500
			set_aggro_range_measure_from = self
		}
	}
}

create_mem_vazuran_weapon_fleet = {
	create_fleet = {
		name = "Planetkiller"
		settings = {
			spawn_debris = no 
			is_boss = yes
		}
		effect = {
			set_owner = event_target:mem_vazurans_country
			create_ship = {
				name = random
				design = "NAME_Vazuran_Weapon"
				graphical_culture = "mem_ancient_02"
			}
			set_location = {
				target = PREV
				distance = 0
				angle = random 
			}
			set_formation_scale = 5
			set_fleet_stance = aggressive
			set_aggro_range = 500
			set_aggro_range_measure_from = self
		}
	}
	last_created_fleet = {
		set_fleet_flag = mem_vazurans_home_fleet
	}
}

create_mem_vazuran_extermination_fleet = {
	create_fleet = {
		name = "Planetkiller"
		settings = {
			spawn_debris = no 
			is_boss = yes
		}
		effect = {
			set_owner = event_target:mem_vazurans_country
			create_ship = {
				name = random
				design = "NAME_Vazuran_Weapon"
				graphical_culture = "mem_ancient_02"
			}
			set_location = {
				target = PREV
				distance = 0
				angle = random 
			}
			set_formation_scale = 5
			set_fleet_stance = aggressive
			set_aggro_range = 500
			set_aggro_range_measure_from = self
		}
	}
	last_created_fleet = {
		set_fleet_flag = mem_vazurans_extermination_fleet
	}
}

# Retaliation effect (planet scope)
mem_vazurans_planet_retaliation_effect = {
#	add_modifier = {
#		modifier = mem_vazurans_raided
#		days = 3600
#	}
	set_timed_planet_flag = {
		flag = mem_vazurans_raided_planet
		days = 27000 # 75 years
	}
	if = {
		limit = {
			habitable_structure = yes
		}
		add_deposit = d_mem_vazuran_ruined_section
		add_deposit = d_mem_vazuran_ruined_section
		add_deposit = d_mem_vazuran_ruined_section
		add_deposit = d_mem_vazuran_ruined_section
	}
	else = {
		add_deposit = d_mem_vazuran_bomb_crater
		add_deposit = d_mem_vazuran_bomb_crater
		add_deposit = d_city_ruins
		add_deposit = d_city_ruins
	}
	IF = {
		limit = {
			OR = {
				has_building = building_mem_planetary_shield_generator
				has_building = building_mem_planetary_shield_generator_heavy
				has_building = building_mem_planetary_shield_generator_orila
			}
		}
		IF = {
			limit = {
				has_global_flag = galactic_focus_crisis_vazurans_1
				owner = {
					is_galactic_community_member = yes
				}
			}
			add_planet_devastation = 40
			IF = {
				limit = {
					num_pops > 10
				}
				while = {
					count = 4
					random_owned_pop = {
						kill_pop = yes
					}
				}
			}
		}
		else = {
			add_planet_devastation = 50
			IF = {
				limit = {
					num_pops > 10
				}
				while = {
					count = 5
					random_owned_pop = {
						kill_pop = yes
					}
				}
			}
		}
	}
	ELSE = {
		IF = {
			limit = {
				has_global_flag = galactic_focus_crisis_vazurans_1
				owner = {
					is_galactic_community_member = yes
				}
			}
			add_planet_devastation = 80
			IF = {
				limit = {
					num_pops > 70
				}
				while = {
					count = 4
					random_owned_pop = {
						kill_pop = yes
					}
				}
			}
			IF = {
				limit = {
					num_pops > 20
				}
				while = {
					count = 4
					random_owned_pop = {
						kill_pop = yes
					}
				}
			}
			IF = {
				limit = {
					num_pops > 10
				}
				while = {
					count = 4
					random_owned_pop = {
						kill_pop = yes
					}
				}
			}
		}
		else = {
			add_planet_devastation = 100
			IF = {
				limit = {
					num_pops > 70
				}
				while = {
					count = 5
					random_owned_pop = {
						kill_pop = yes
					}
				}
			}
			IF = {
				limit = {
					num_pops > 20
				}
				while = {
					count = 5
					random_owned_pop = {
						kill_pop = yes
					}
				}
			}
			IF = {
				limit = {
					num_pops > 10
				}
				while = {
					count = 5
					random_owned_pop = {
						kill_pop = yes
					}
				}
			}
		}
	}
}

# Raiding effect 1 no colony destruction (planet scope)
mem_vazurans_planet_raiding_effect_1 = {
#	add_modifier = {
#		modifier = mem_vazurans_raided
#		days = 3600
#	}
	IF = {
		limit = {
			is_star = no
		}
		save_event_target_as = mem_vazurans_raid_planet_name
		set_timed_planet_flag = {
			flag = mem_vazurans_raided_planet
			days = 27000 # 75 years
		}
		if = {
			limit = {
				habitable_structure = yes
			}
			add_deposit = d_mem_vazuran_ruined_section
		}
		else = {
			add_deposit = d_mem_vazuran_bomb_crater
		}
		IF = {
			limit = {
				OR = {
					has_building = building_mem_planetary_shield_generator
					has_building = building_mem_planetary_shield_generator_heavy
					has_building = building_mem_planetary_shield_generator_orila
				}
			}
			IF = {
				limit = {
					has_global_flag = galactic_focus_crisis_vazurans_1
					owner = {
						is_galactic_community_member = yes
					}
				}
				add_planet_devastation = 20
				IF = {
					limit = {
						num_pops > 10
					}
					while = {
						count = 4
						random_owned_pop = {
							kill_pop = yes
						}
					}
				}
			}
			else = {
				add_planet_devastation = 25
				IF = {
					limit = {
						num_pops > 10
					}
					while = {
						count = 5
						random_owned_pop = {
							kill_pop = yes
						}
					}
				}
			}
		}
		ELSE = {
			IF = {
				limit = {
					has_global_flag = galactic_focus_crisis_vazurans_1
					owner = {
						is_galactic_community_member = yes
					}
				}
				add_planet_devastation = 40
				IF = {
					limit = {
						num_pops > 70
					}
					while = {
						count = 4
						random_owned_pop = {
							kill_pop = yes
						}
					}
				}
				IF = {
					limit = {
						num_pops > 20
					}
					while = {
						count = 4
						random_owned_pop = {
							kill_pop = yes
						}
					}
				}
				IF = {
					limit = {
						num_pops > 10
					}
					while = {
						count = 4
						random_owned_pop = {
							kill_pop = yes
						}
					}
				}
			}
			else = {
				add_planet_devastation = 50
				IF = {
					limit = {
						num_pops > 70
					}
					while = {
						count = 5
						random_owned_pop = {
							kill_pop = yes
						}
					}
				}
				IF = {
					limit = {
						num_pops > 20
					}
					while = {
						count = 5
						random_owned_pop = {
							kill_pop = yes
						}
					}
				}
				IF = {
					limit = {
						num_pops > 10
					}
					while = {
						count = 5
						random_owned_pop = {
							kill_pop = yes
						}
					}
				}
			}
		}
	}	
}

# Raiding effect 2 colony destruction (planet scope)
mem_vazurans_planet_raiding_effect_2 = {
	IF = {
		limit = {
			is_star = no
		}
		if = {
			limit = {
				habitable_structure = yes
			}
			add_deposit = d_mem_vazuran_ruined_section
			add_deposit = d_mem_vazuran_ruined_section
			add_deposit = d_mem_vazuran_ruined_section
			add_deposit = d_mem_vazuran_ruined_section
		}
		else = {
			add_deposit = d_mem_vazuran_bomb_crater
			add_deposit = d_mem_vazuran_bomb_crater
			add_deposit = d_city_ruins
			add_deposit = d_city_ruins
		}
		add_planet_devastation = 100
		every_galaxy_pop = {
			limit = {
				planet = {
					is_same_value = root
				}
			}
			kill_pop = yes
		}
	}
}

# Raiding effect 3 colony destruction nuked (planet scope)
mem_vazurans_planet_raiding_effect_3 = {
	IF = {
		limit = {
			is_star = no
		}
		add_deposit = d_mem_vazuran_bomb_crater
		add_deposit = d_mem_vazuran_bomb_crater
		add_deposit = d_city_ruins
		add_deposit = d_city_ruins
		add_planet_devastation = 100
		every_galaxy_pop = {
			limit = {
				planet = {
					is_same_value = root
				}
			}
			kill_pop = yes
		}
		change_pc = pc_nuked
	}
}

mem_vazuran_raiding_fleet_spawn = {
	IF = { # weakest raiding fleet if not having researched destroyers yet
		limit = {
			ROOT = {
				NOT = {
					has_technology = tech_destroyers
				}
			}
		}
		create_mem_vazuran_corvette_stage_fleet = yes
	}
	IF = { # raiding fleet if not having researched cruisers yet
		limit = {
			ROOT = {
				has_technology = tech_destroyers
				NOT = {
					has_technology = tech_cruisers
				}
			}
		}
		create_mem_vazuran_destroyer_stage_fleet = yes
	}
	IF = { # raiding fleet if not having researched battleships yet
		limit = {
			ROOT = {
				has_technology = tech_cruisers
				NOT = {
					has_technology = tech_battleships
				}
			}
		}
		create_mem_vazuran_cruiser_stage_fleet = yes
	}
	IF = { # raiding fleet if not having researched any xl t1 weapon yet
		limit = {
			ROOT = {
				has_technology = tech_battleships
				NOR = {
					has_technology = tech_energy_lance_1
					has_technology = tech_mass_accelerator_1
					has_technology = tech_arc_emitter_1
				}
			}
		}
		create_mem_vazuran_battleship_stage_fleet = yes
	}
	IF = { # raiding fleet if not having researched any xl t2 weapon yet
		limit = {
			ROOT = {
				OR = {
					has_technology = tech_energy_lance_1
					has_technology = tech_mass_accelerator_1
					has_technology = tech_arc_emitter_1
				}
				NOR = {
					has_technology = tech_energy_lance_2
					has_technology = tech_mass_accelerator_2
					has_technology = tech_arc_emitter_2
				}
			}
		}
		create_mem_vazuran_xl_01_stage_fleet = yes
	}
	IF = { # raiding fleet if having researched any xl t2 weapon
		limit = {
			ROOT = {
				OR = {
					has_technology = tech_energy_lance_2
					has_technology = tech_mass_accelerator_2
					has_technology = tech_arc_emitter_2
				}
			}
		}
		create_mem_vazuran_xl_02_stage_fleet = yes
	}
}

setup_mem_ruined_vazuran_space = {
	no_scope = {
		# makes system positions originate from galactic core
		spawn_system = { 
			min_distance >= 550
			max_distance <= 560
			min_orientation_angle = 96
			max_orientation_angle = 102
			initializer = "mem_vazuran_homesystem_ruined"
			hyperlane = no
		}
	}
	while = {
		count = 3
		random_system = {
			limit = {
				has_owner = no
				NOR = {
					has_star_flag = hostile_system
					has_star_flag = enclave
					has_star_flag = guardian
					has_star_flag = abandoned_gateway
					has_star_flag = lgate
					has_star_flag = mem_vazuran_homesystem
					has_star_flag = mem_vazuran_rift_placement
					has_natural_wormhole = yes
				}
			}
			#set_star_flag = mem_vazuran_portal
			# make the megastructure
			spawn_megastructure = {
				type = "mem_vazuran_gateway_endpoint"
				random_pos = yes
				orbit_angle = 360		# range of the randomization
			}
			random_megastructure = {
				limit = {
					is_megastructure_type = mem_vazuran_gateway_endpoint
				}
				create_ambient_object = {
					type = mem_vazuran_wormhole_big_object
				}
			}
			set_star_flag = mem_vazuran_rift_placement
			every_system = {
				limit = {
					distance = {
						source = PREV
						max_distance <= 100
					}
				}
				set_star_flag = mem_vazuran_rift_placement
			}
		}
	}
	while = {
		count = 5
		random_system = {
			limit = {
				has_owner = no
				NOR = {
					has_star_flag = hostile_system
					has_star_flag = enclave
					has_star_flag = guardian
					has_star_flag = abandoned_gateway
					has_star_flag = lgate
					has_star_flag = mem_vazuran_homesystem
					has_star_flag = mem_vazuran_rift_placement
					has_natural_wormhole = yes
					#any_system = {
					#	OR = {
					#		has_megastructure = mem_vazuran_gateway_endpoint_ruined
					#		has_megastructure = mem_vazuran_gateway_endpoint
					#	}                        
                    #    distance = {
                    #        source = prev
                    #        max_jumps = 5
                    #    }
                    #}
				}
			}
			# make the megastructure
			spawn_megastructure = {
				type = "mem_vazuran_gateway_endpoint_ruined"
				random_pos = yes
				orbit_angle = 360		# range of the randomization
			}
			set_star_flag = mem_vazuran_rift_placement
			every_system = {
				limit = {
					distance = {
						source = PREV
						max_distance <= 100
					}
				}
				set_star_flag = mem_vazuran_rift_placement
			}
		}
	}
}